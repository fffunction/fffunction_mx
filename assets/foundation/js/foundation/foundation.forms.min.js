(function(e,t,s,i){"use strict";Foundation.libs.forms={name:"forms",version:"4.1.6",cache:{},settings:{disable_class:"no-custom",last_combo:null},init:function(t,s,i){if(typeof s==="object"){e.extend(true,this.settings,s)}if(typeof s!="string"){if(!this.settings.init){this.events()}this.assemble();return this.settings.init}else{return this[s].call(this,i)}},assemble:function(){e('form.custom input[type="radio"]',e(this.scope)).not('[data-customforms="disabled"]').each(this.append_custom_markup);e('form.custom input[type="checkbox"]',e(this.scope)).not('[data-customforms="disabled"]').each(this.append_custom_markup);e("form.custom select",e(this.scope)).not('[data-customforms="disabled"]').not("[multiple=multiple]").each(this.append_custom_select)},events:function(){var i=this;e(this.scope).on("click.fndtn.forms","form.custom span.custom.checkbox",function(t){t.preventDefault();t.stopPropagation();i.toggle_checkbox(e(this))}).on("click.fndtn.forms","form.custom span.custom.radio",function(t){t.preventDefault();t.stopPropagation();i.toggle_radio(e(this))}).on("change.fndtn.forms",'form.custom select:not([data-customforms="disabled"])',function(t,s){i.refresh_custom_select(e(this),s)}).on("click.fndtn.forms","form.custom label",function(t){if(e(t.target).is("label")){var s=e("#"+i.escape(e(this).attr("for"))+':not([data-customforms="disabled"])'),o,n;if(s.length!==0){if(s.attr("type")==="checkbox"){t.preventDefault();o=e(this).find("span.custom.checkbox");if(o.length==0){o=s.add(this).siblings("span.custom.checkbox").first()}i.toggle_checkbox(o)}else if(s.attr("type")==="radio"){t.preventDefault();n=e(this).find("span.custom.radio");if(n.length==0){n=s.add(this).siblings("span.custom.radio").first()}i.toggle_radio(n)}}}}).on("mousedown.fndtn.forms","form.custom div.custom.dropdown",function(){return false}).on("click.fndtn.forms","form.custom div.custom.dropdown a.current, form.custom div.custom.dropdown a.selector",function(t){var s=e(this),n=s.closest("div.custom.dropdown"),a=o(n,"select");if(!n.hasClass("open"))e(i.scope).trigger("click");t.preventDefault();if(false===a.is(":disabled")){n.toggleClass("open");if(n.hasClass("open")){e(i.scope).on("click.fndtn.forms.customdropdown",function(){n.removeClass("open");e(i.scope).off(".fndtn.forms.customdropdown")})}else{e(i.scope).on(".fndtn.forms.customdropdown")}return false}}).on("click.fndtn.forms touchend.fndtn.forms","form.custom div.custom.dropdown li",function(t){var s=e(this),i=s.closest("div.custom.dropdown"),n=o(i,"select"),a=0;t.preventDefault();t.stopPropagation();if(!e(this).hasClass("disabled")){e("div.dropdown").not(i).removeClass("open");var l=s.closest("ul").find("li.selected");l.removeClass("selected");s.addClass("selected");i.removeClass("open").find("a.current").text(s.text());s.closest("ul").find("li").each(function(e){if(s[0]==this){a=e}});n[0].selectedIndex=a;n.data("prevalue",l.html());n.trigger("change")}});e(t).on("keydown",function(t){var i=s.activeElement,o=Foundation.libs.forms,n=e(".custom.dropdown.open");if(n.length>0){t.preventDefault();if(t.which===13){n.find("li.selected").trigger("click")}if(t.which===27){n.removeClass("open")}if(t.which>=65&&t.which<=90){var a=o.go_to(n,t.which),l=n.find("li.selected");if(a){l.removeClass("selected");o.scrollTo(a.addClass("selected"),300)}}if(t.which===38){var l=n.find("li.selected"),d=l.prev(":not(.disabled)");if(d.length>0){d.parent()[0].scrollTop=d.parent().scrollTop()-o.outerHeight(d);l.removeClass("selected");d.addClass("selected")}}else if(t.which===40){var l=n.find("li.selected"),a=l.next(":not(.disabled)");if(a.length>0){a.parent()[0].scrollTop=a.parent().scrollTop()+o.outerHeight(a);l.removeClass("selected");a.addClass("selected")}}}});this.settings.init=true},go_to:function(e,t){var s=e.find("li"),i=s.length;if(i>0){for(var o=0;o<i;o++){var n=s.eq(o).text().charAt(0).toLowerCase();if(n===String.fromCharCode(t).toLowerCase())return s.eq(o)}}},scrollTo:function(e,t){if(t<0)return;var s=e.parent();var i=this.outerHeight(e);var o=i*e.index()-s.scrollTop();var n=o/t*10;this.scrollToTimerCache=setTimeout(function(){if(!isNaN(parseInt(n,10))){s[0].scrollTop=s.scrollTop()+n;this.scrollTo(e,t-10)}}.bind(this),10)},append_custom_markup:function(t,s){var i=e(s),o=i.attr("type"),n=i.next("span.custom."+o);if(n.length===0){n=e('<span class="custom '+o+'"></span>').insertAfter(i)}n.toggleClass("checked",i.is(":checked"));n.toggleClass("disabled",i.is(":disabled"))},append_custom_select:function(t,s){var i=Foundation.libs.forms,o=e(s),n=o.next("div.custom.dropdown"),a=n.find("ul"),l=n.find(".current"),d=n.find(".selector"),r=o.find("option"),c=r.filter(":selected"),f=o.attr("class")?o.attr("class").split(" "):[],h=0,u="",m,p=false;if(o.hasClass(i.settings.disable_class))return;if(n.length===0){var g=o.hasClass("small")?"small":o.hasClass("medium")?"medium":o.hasClass("large")?"large":o.hasClass("expand")?"expand":"";n=e('<div class="'+["custom","dropdown",g].concat(f).filter(function(e,t,s){if(e=="")return false;return s.indexOf(e)==t}).join(" ")+'"><a href="#" class="selector"></a><ul /></div>');d=n.find(".selector");a=n.find("ul");u=r.map(function(){var t=e(this).attr("class")?e(this).attr("class"):"";return"<li class='"+t+"'>"+e(this).html()+"</li>"}).get().join("");a.append(u);p=n.prepend('<a href="#" class="current">'+c.html()+"</a>").find(".current");o.after(n).addClass("hidden-field")}else{u=r.map(function(){return"<li>"+e(this).html()+"</li>"}).get().join("");a.html("").append(u)}i.assign_id(o,n);n.toggleClass("disabled",o.is(":disabled"));m=a.find("li");i.cache[n.data("id")]=m.length;r.each(function(t){if(this.selected){m.eq(t).addClass("selected");if(p){p.html(e(this).html())}}if(e(this).is(":disabled")){m.eq(t).addClass("disabled")}});if(!n.is(".small, .medium, .large, .expand")){n.addClass("open");var i=Foundation.libs.forms;i.hidden_fix.adjust(a);h=i.outerWidth(m)>h?i.outerWidth(m):h;Foundation.libs.forms.hidden_fix.reset();n.removeClass("open")}},assign_id:function(e,t){var s=[+new Date,Foundation.random_str(5)].join("-");e.attr("data-id",s);t.attr("data-id",s)},refresh_custom_select:function(t,s){var i=this;var o=0,n=t.next(),a=t.find("option"),l=n.find("li");if(l.length!=this.cache[n.data("id")]||s){n.find("ul").html("");a.each(function(){var t=e("<li>"+e(this).html()+"</li>");n.find("ul").append(t)});a.each(function(t){if(this.selected){n.find("li").eq(t).addClass("selected");n.find(".current").html(e(this).html())}if(e(this).is(":disabled")){n.find("li").eq(t).addClass("disabled")}});n.removeAttr("style").find("ul").removeAttr("style");n.find("li").each(function(){n.addClass("open");if(i.outerWidth(e(this))>o){o=i.outerWidth(e(this))}n.removeClass("open")});l=n.find("li");this.cache[n.data("id")]=l.length}},toggle_checkbox:function(e){var t=e.prev(),s=t[0];if(false===t.is(":disabled")){s.checked=s.checked?false:true;e.toggleClass("checked");t.trigger("change")}},toggle_radio:function(e){var t=e.prev(),s=t.closest("form.custom"),i=t[0];if(false===t.is(":disabled")){s.find('input[type="radio"][name="'+this.escape(t.attr("name"))+'"]').next().not(e).removeClass("checked");if(!e.hasClass("checked")){e.toggleClass("checked")}i.checked=e.hasClass("checked");t.trigger("change")}},escape:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},hidden_fix:{tmp:[],hidden:null,adjust:function(t){var s=this;s.hidden=t.parents().addBack().filter(":hidden");s.hidden.each(function(){var t=e(this);s.tmp.push(t.attr("style"));t.css({visibility:"hidden",display:"block"})})},reset:function(){var t=this;t.hidden.each(function(s){var o=e(this),n=t.tmp[s];if(n===i)o.removeAttr("style");else o.attr("style",n)});t.tmp=[];t.hidden=null}},off:function(){e(this.scope).off(".fndtn.forms")}};var o=function(t,s){var t=t.prev();while(t.length){if(t.is(s))return t;t=t.prev()}return e()}})(Foundation.zj,this,this.document);